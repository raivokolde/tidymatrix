% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pca.R
\name{compute_prcomp}
\alias{compute_prcomp}
\title{Compute PCA on tidymatrix}
\usage{
compute_prcomp(x, name = NULL, n_components = NULL, store = TRUE, ...)
}
\arguments{
\item{x}{A tidymatrix object}

\item{name}{Name for this analysis. Default is "row_pca" or "column_pca"
depending on active component. Used as prefix for column names.}

\item{n_components}{Number of PC components to add to metadata. Default is
all components. Use a smaller number for large datasets.}

\item{store}{If TRUE, stores the full prcomp object for later retrieval
with \code{get_analysis()}. Default is TRUE.}

\item{...}{Additional arguments passed to \code{stats::prcomp()}, such as
\code{center}, \code{scale.}, \code{tol}, etc.}
}
\value{
A tidymatrix object with PC scores added to metadata
}
\description{
Perform Principal Component Analysis on the matrix, adding PC scores to
metadata and optionally storing the full prcomp object.
}
\details{
This function wraps \code{stats::prcomp()} and passes all additional
parameters directly to it. The PC scores are added as columns to the
active metadata (row_data or col_data).
}
\examples{
mat <- matrix(rnorm(100), nrow = 10, ncol = 10)
row_data <- data.frame(id = 1:10, group = rep(c("A", "B"), each = 5))
col_data <- data.frame(id = 1:10, type = rep(c("x", "y"), 5))
tm <- tidymatrix(mat, row_data, col_data)

# PCA on columns (samples)
tm <- tm |>
  activate(columns) |>
  compute_prcomp(center = TRUE, scale. = TRUE)

# Now col_data has column_pca_PC1, column_pca_PC2, etc.

# Custom name and limited components
tm <- tm |>
  activate(rows) |>
  compute_prcomp(name = "gene_pca", n_components = 3, center = TRUE)

# Get full prcomp object
pca_obj <- get_analysis(tm, "gene_pca")
summary(pca_obj)
plot(pca_obj$sdev^2 / sum(pca_obj$sdev^2))  # Variance explained
}
