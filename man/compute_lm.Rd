% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute-across.R
\name{compute_lm}
\alias{compute_lm}
\title{Convenience wrapper for linear models}
\usage{
compute_lm(
  .data,
  formula_rhs,
  coef = NULL,
  adjust = "fdr",
  add_to_data = FALSE,
  prefix = NULL,
  return_tibble = TRUE,
  ...
)
}
\arguments{
\item{.data}{A tidymatrix object with rows or columns active}

\item{formula_rhs}{Right-hand side of formula (e.g., \code{~ condition + batch + age})}

\item{coef}{Character. Name of coefficient to extract. If NULL, returns overall
model statistics}

\item{adjust}{Character. Method for p-value adjustment. Default "fdr".
Use "none" for no adjustment}

\item{...}{Additional arguments passed to \code{lm()}}
}
\value{
A data.frame/tibble with model statistics. If \code{coef} specified:
estimate, p.value, se, and p.adj. If \code{coef = NULL}: r.squared, f.statistic,
p.value, and p.adj
}
\description{
Fits linear models for each row (or column) of a tidymatrix. Can return
statistics for a specific coefficient or overall model fit statistics.
}
\examples{
mat <- matrix(rnorm(100), nrow = 10, ncol = 10)
col_data <- data.frame(
  sample = paste0("S", 1:10),
  condition = factor(rep(c("Control", "Treatment"), each = 5)),
  batch = factor(rep(1:2, 5)),
  age = rnorm(10, 50, 10)
)
row_data <- data.frame(gene = paste0("Gene", 1:10))
tm <- tidymatrix(mat, row_data, col_data)

# Extract specific coefficient
results <- tm |>
  activate(rows) |>
  compute_lm(
    formula_rhs = ~ condition + batch + age,
    coef = "conditionTreatment"
  )

# Overall model statistics
results <- tm |>
  activate(rows) |>
  compute_lm(formula_rhs = ~ condition + batch + age)
}
